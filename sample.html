<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D3.js Three Scenes with Index Buttons</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        /* Basic styling */
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding-top: 20px;
        }

        .scene {
            display: none;
        }

        .scene.active {
            display: block;
        }

        .button-container {
            margin-top: 20px;
        }

        .button-container button {
            margin: 0 10px;
            padding: 10px 20px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
        }

        .button-container button:hover {
            background-color: #0056b3;
        }
        circle {
            fill: lightblue;
            stroke: black;
        }
    </style>
</head>

<body>

    <!-- Scene 1: Bar Chart -->
    <div class="scene active" id="scene1">
        <h2>EU Life Expectancy Time Series</h2>
        <svg width="400" height="300"></svg>
    </div>

    <!-- Scene 2: Scatter Plot -->
    <div class="scene" id="scene2">
        <h2>Life Expectancy by EU Countries</h2>
        <svg width="400" height="300"></svg>
    </div>

    <!-- Scene 3: Line Chart -->
    <div class="scene" id="scene3">
        <h2>Life Expectancy vs GDP</h2>
        <svg width="400" height="300"></svg>
    </div>

    <!-- Index Buttons -->
    <div class="button-container">
        <button onclick="showScene(1)">Scene 1</button>
        <button onclick="showScene(2)">Scene 2</button>
        <button onclick="showScene(3)">Scene 3</button>
    </div>

    <script>
        // D3.js code for each scene

        // Scene 1: Bar Chart
        const svg1 = d3.select('#scene1 svg');

        // Scene 2: Scatter Plot
        const svg2 = d3.select('#scene2 svg');

        const data2 = [
            { x: 10, y: 20 },
            { x: 30, y: 40 },
            { x: 50, y: 60 },
            { x: 70, y: 80 },
            { x: 90, y: 100 }
        ];

        svg2.selectAll('circle')
            .data(data2)
            .enter()
            .append('circle')
            .attr('cx', d => d.x)
            .attr('cy', d => d.y)
            .attr('r', 5)
            .attr('fill', 'green');

        // Scene 3: Line Chart
        const svg3 = d3.select('#scene3 svg');

        // Function to switch scenes
        function showScene(sceneIndex) {
            // Hide all scenes
            d3.selectAll('.scene')
                .classed('active', false);

            // Show the selected scene
            if (sceneIndex == 1) {
                d3.select(`#scene${sceneIndex}`)
                    .classed('active', true);
                loadSceneOne();
            } else if (sceneIndex == 3){
                d3.select(`#scene${sceneIndex}`)
                    .classed('active', true);
                init();
            } else {
                d3.select(`#scene${sceneIndex}`)
                    .classed('active', true);
            }
        }
        async function init() {
            var x = d3.scaleLog([10, 150], [0, 200]);
            var y = d3.scaleLog([150, 10], [0, 200]);
            const data = await d3.csv('https://flunky.github.io/cars2017.csv');
            svg3.append("g").attr("transform", "translate(50,50)").selectAll("circle").data(data).enter().append("circle").attr("cx", function (d, i) { return x(Number(d.AverageCityMPG)) }).attr("cy", function (d, i) { return y(Number(d.AverageHighwayMPG)) }).attr("r", function (d, i) { return (Number(d.EngineCylinders) + 2) });
            svg3.append("g").attr("transform", "translate(50,50)").call(d3.axisLeft(y).tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s")));
            svg3.append("g").attr("transform", "translate(50,250)").call(d3.axisBottom(x).tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s")));
        }

        async function loadSceneOne() {

            d3.csv("eu_life.csv", function (data) {
                console.log(data);
            }, function (error, rows) {
                console.log(rows);
            });

            var x = d3.scaleLog([10, 150], [0, 200]);
            var y = d3.scaleLog([150, 10], [0, 200]);
            //const data = await d3.csv('https://flunky.github.io/cars2017.csv');
            //svg1.append("g").attr("transform", "translate(50,50)").selectAll("circle").data(data).enter().append("circle").attr("cx", function (d, i) { return x(Number(d.AverageCityMPG)) }).attr("cy", function (d, i) { return y(Number(d.AverageHighwayMPG)) }).attr("r", function (d, i) { return (Number(d.EngineCylinders) + 2) });
            svg1.append("g").attr("transform", "translate(50,50)").call(d3.axisLeft(y).tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s")));
            svg1.append("g").attr("transform", "translate(50,250)").call(d3.axisBottom(x).tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s")));

        }

    </script>

</body>

</html>